!function(t){var e={};function i(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(r,s,function(e){return t[e]}.bind(null,s));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=10)}([function(t,e,i){"use strict";i.r(e);e.default=class{constructor(t){this._matrix=t}get matrix(){return this._matrix}set matrix(t){this._matrix=t}}},function(t,e,i){"use strict";i.r(e);var r=i(2),s=i(3),a=i(4),n=i(5),o=i(6),h=i(7),l=i(8),c=i(0);e.default=class{constructor(t,e,i,u,x,p,d,f){this.canvas=t,this.context=e,this.backgroundColor=u,this.arena=new c.default(this.createMatrix(f.x,f.y)),this.player=x,this.pieceColors=p,this.scoreEl=d,this.dropCounter=0,this.dropInterval=1e3,this.lastTime=0,this.context.scale(i.x,i.y),this.pieces=[new r.default,new s.default,new a.default,new n.default,new o.default,new h.default,new l.default],this.KEY_ARROW_DOWN=40,this.KEY_ARROW_LEFT=37,this.KEY_ARROW_RIGHT=39,this.KEY_Q=81,this.KEY_W=87,this.context.fillRect(0,0,this.canvas.clientWidth,this.canvas.clientHeight)}arenaSweep(){let t=1;t:for(let e=this.arena.matrix.length-1;e>0;--e){for(let t=0;t<this.arena.matrix[e].length;++t)if(0===this.arena.matrix[e][t])continue t;const i=this.arena.matrix.splice(e,1)[0].fill(0);this.arena.matrix.unshift(i),++e,this.player.score+=10*t,t*=2}}haveCollided(){const[t,e]=[this.player.matrix,this.player.position];for(let i=0;i<t.length;++i)for(let r=0;r<t[i].length;++r)if(0!==t[i][r]&&0!==(this.arena.matrix[i+e.y]&&this.arena.matrix[i+e.y][r+e.x]))return!0;return!1}createMatrix(t,e){const i=[];for(;e--;)i.push(new Array(t).fill(0));return i}draw(){this.context.fillStyle=this.backgroundColor,this.context.fillRect(0,0,this.canvas.clientWidth,this.canvas.clientHeight),this.drawMatrix(this.arena.matrix,{x:0,y:0}),this.drawMatrix(this.player.matrix,this.player.position)}drawMatrix(t,e){t.forEach((t,i)=>{t.forEach((t,r)=>{0!==t&&(this.context.fillStyle=this.pieceColors[t],this.context.fillRect(r+e.x,i+e.y,1,1))})})}merge(){this.player.matrix.forEach((t,e)=>{t.forEach((t,i)=>{0!==t&&(this.arena.matrix[e+this.player.position.y][i+this.player.position.x]=t)})})}playerDrop(){this.player.position.y++,this.haveCollided()&&(this.player.position.y--,this.merge(),this.playerReset(),this.arenaSweep(),this.updateScore()),this.dropCounter=0}playerMove(t){this.player.position.x+=t,this.haveCollided()&&(this.player.position.x-=t)}getRandomPiece(){return this.pieces[this.pieces.length*Math.random()|0]}playerReset(){this.player.matrix=this.getRandomPiece().matrix,this.player.position.y=0,this.player.position.x=(this.arena.matrix[0].length/2|0)-(this.player.matrix[0].length/2|0),this.haveCollided()&&(this.arena.matrix.forEach(t=>t.fill(0)),this.player.score=0,this.updateScore())}playerRotate(t){const e=this.player.position.x;let i=1;for(this.rotateMatrix(this.player.matrix,t);this.haveCollided();)if(this.player.position.x+=i,i=-(i+(i>0?1:-1)),i>this.player.matrix[0].length)return this.rotateMatrix(this.player.matrix,-t),void(this.player.position.x=e)}rotateMatrix(t,e){for(let e=0;e<t.length;++e)for(let i=0;i<e;++i)[t[i][e],t[e][i]]=[t[e][i],t[i][e]];e>0?t.forEach(t=>t.reverse()):t.reverse()}update(t=0){const e=t-this.lastTime;this.lastTime=t,this.dropCounter+=e,this.dropCounter>this.dropInterval&&this.playerDrop(),this.draw(),requestAnimationFrame(this.update.bind(this))}updateScore(){this.scoreEl.innerText=this.player.score}handleKeyEvent(t){t===this.KEY_ARROW_LEFT&&this.playerMove(-1),t===this.KEY_ARROW_RIGHT&&this.playerMove(1),t===this.KEY_ARROW_DOWN&&this.playerDrop(),t===this.KEY_Q&&this.playerRotate(-1),t===this.KEY_W&&this.playerRotate(1)}init(){this.playerReset(),this.updateScore(),this.update()}}},function(t,e,i){"use strict";i.r(e);e.default=class{constructor(){this._matrix=[[0,5,0,0],[0,5,0,0],[0,5,0,0],[0,5,0,0]]}get matrix(){return this._matrix}set matrix(t){this._matrix=t}}},function(t,e,i){"use strict";i.r(e);e.default=class{constructor(){this._matrix=[[0,4,0],[0,4,0],[4,4,0]]}get matrix(){return this._matrix}set matrix(t){this._matrix=t}}},function(t,e,i){"use strict";i.r(e);e.default=class{constructor(){this._matrix=[[0,3,0],[0,3,0],[0,3,3]]}get matrix(){return this._matrix}set matrix(t){this._matrix=t}}},function(t,e,i){"use strict";i.r(e);e.default=class{constructor(){this._matrix=[[2,2],[2,2]]}get matrix(){return this._matrix}set matrix(t){this._matrix=t}}},function(t,e,i){"use strict";i.r(e);e.default=class{constructor(){this._matrix=[[0,6,6],[6,6,0],[0,0,0]]}get matrix(){return this._matrix}set matrix(t){this._matrix=t}}},function(t,e,i){"use strict";i.r(e);e.default=class{constructor(){this._matrix=[[0,0,0],[1,1,1],[0,1,0]]}get matrix(){return this._matrix}set matrix(t){this._matrix=t}}},function(t,e,i){"use strict";i.r(e);e.default=class{constructor(){this._matrix=[[7,7,0],[0,7,7],[0,0,0]]}get matrix(){return this._matrix}set matrix(t){this._matrix=t}}},function(t,e,i){"use strict";i.r(e);e.default=class{constructor(){this._position={x:0,y:0},this._matrix=null,this._score=0}get matrix(){return this._matrix}set matrix(t){this._matrix=t}get score(){return this._score}set score(t){this._score=t}get position(){return this._position}set position(t){this._position=t}}},function(t,e,i){i(0),i(1),i(9),i(11),i(12),i(13),i(14),i(2),i(3),i(4),i(5),i(6),i(7),t.exports=i(8)},function(t,e,i){"use strict";i.r(e);var r=i(1),s=i(9);const a=document.getElementById("tetris"),n=a.getContext("2d"),o=document.getElementById("score"),h=new s.default,l=new r.default(a,n,{x:20,y:20},"#000",h,[null,"red","blue","violet","green","purple","orange","pink"],o,{x:12,y:20});document.addEventListener("keydown",t=>{l.handleKeyEvent(t.keyCode)}),l.init()},function(t,e){},function(t,e){},function(t,e){}]);